<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Project Owners • zoltr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Project Owners">
<meta property="og:description" content="zoltr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">zoltr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting-started.html">Getting Started</a>
    </li>
    <li>
      <a href="../articles/project-owners.html">Project Owners</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/reichlab/zoltr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Project Owners</h1>
                        <h4 data-toc-skip class="author">Matthew
Cornell</h4>
            
            <h4 data-toc-skip class="date">2022-04-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/reichlab/zoltr/blob/HEAD/vignettes/project-owners.Rmd" class="external-link"><code>vignettes/project-owners.Rmd</code></a></small>
      <div class="hidden name"><code>project-owners.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="zoltr-for-project-owners">zoltr for Project Owners<a class="anchor" aria-label="anchor" href="#zoltr-for-project-owners"></a>
</h2>
<p>Welcome to the zoltr vignette for project owners and forecasters. You
should read this if you are interested in creating and managing your own
<a href="https://www.zoltardata.com/" class="external-link">zoltardata.com</a> projects using
this package to access them via the Zoltar API. Building on the
<em>Getting Started</em> vignette, this one covers creating projects and
models, and uploading forecasts.</p>
<p>Before starting, you should have an account on <a href="https://www.zoltardata.com/" class="external-link">zoltardata.com</a>, and an <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Startup.html" class="external-link"><code>.Renviron</code></a>
file set up as described in <em>Getting Started</em>.</p>
<div class="section level3">
<h3 id="connect-to-the-host-and-authenticate">Connect to the host and authenticate<a class="anchor" aria-label="anchor" href="#connect-to-the-host-and-authenticate"></a>
</h3>
<!-- run but don't show. NB: will run only if above eval=TRUE -->
<!-- run but don't show. NB: will run only if above eval=TRUE -->
<!-- show but don't run-->
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/reichlab/zoltr" class="external-link">zoltr</a></span><span class="op">)</span></span>
<span><span class="va">zoltar_connection</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_connection.html">new_connection</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/zoltar_authenticate.html">zoltar_authenticate</a></span><span class="op">(</span><span class="va">zoltar_connection</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"Z_USERNAME"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"Z_PASSWORD"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="create-a-sandbox-project-to-play-with">Create a sandbox project to play with<a class="anchor" aria-label="anchor" href="#create-a-sandbox-project-to-play-with"></a>
</h3>
<p>Let’s use the <code><a href="../reference/create_project.html">create_project()</a></code> function to make a
temporary project to work with. (Note that if you’re repeating this step
and need to delete a previously-created project, you can either use the
web UI’s delete button on the project detail page or call the zoltr
<code><a href="../reference/delete_project.html">delete_project()</a></code> function to do it programmatically.)
<code><a href="../reference/create_project.html">create_project()</a></code> takes a <code>project_config</code>
parameter that is a <code>list</code> specifying everything Zoltar needs
to create a project, including meta information like name, whether it’s
public, etc. In addition, it lists the units, targets, and timezeros to
create. The new project’s URL is returned, which you can pass to other
functions. Here we use <code>docs-project.json</code>, which is the one
that creates the example documentation project.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">project_config</span> <span class="op">&lt;-</span> <span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/read_json.html" class="external-link">read_json</a></span><span class="op">(</span><span class="st">"docs-project.json"</span><span class="op">)</span>  <span class="co"># "name": "My project"</span></span>
<span><span class="va">project_url</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_project.html">create_project</a></span><span class="op">(</span><span class="va">zoltar_connection</span>, <span class="va">project_config</span><span class="op">)</span></span>
<span><span class="va">the_project_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project_info.html">project_info</a></span><span class="op">(</span><span class="va">zoltar_connection</span>, <span class="va">project_url</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="add-a-model-to-the-project-and-then-upload-a-forecast-into-it">Add a model to the project and then upload a forecast into it<a class="anchor" aria-label="anchor" href="#add-a-model-to-the-project-and-then-upload-a-forecast-into-it"></a>
</h3>
<p>We can use the <code><a href="../reference/create_model.html">create_model()</a></code> function to create a model
in a particular project. Like <code><a href="../reference/create_project.html">create_project()</a></code>, it takes a
<code>list</code> that is the configuration to use when creating the
model. There is an example at <code>example-model-config.json</code>,
but here we will construct the <code>list</code> ourselves.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_config</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"name"</span> <span class="op">=</span> <span class="st">"a model_name"</span>,</span>
<span>                     <span class="st">"abbreviation"</span> <span class="op">=</span> <span class="st">"an abbreviation"</span>,</span>
<span>                     <span class="st">"team_name"</span> <span class="op">=</span> <span class="st">"a team_name"</span>,</span>
<span>                     <span class="st">"description"</span> <span class="op">=</span> <span class="st">"a description"</span>,</span>
<span>                     <span class="st">"contributors"</span> <span class="op">=</span> <span class="st">"the contributors"</span>,</span>
<span>                     <span class="st">"license"</span> <span class="op">=</span> <span class="st">"other"</span>,</span>
<span>                     <span class="st">"notes"</span> <span class="op">=</span> <span class="st">"some notes"</span>,</span>
<span>                     <span class="st">"citation"</span> <span class="op">=</span> <span class="st">"a citation"</span>,</span>
<span>                     <span class="st">"methods"</span> <span class="op">=</span> <span class="st">"the methods"</span>,</span>
<span>                     <span class="st">"home_url"</span> <span class="op">=</span> <span class="st">"http://example.com/"</span>,</span>
<span>                     <span class="st">"aux_data_url"</span> <span class="op">=</span> <span class="st">"http://example.com/"</span><span class="op">)</span></span>
<span><span class="va">model_url</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_model.html">create_model</a></span><span class="op">(</span><span class="va">zoltar_connection</span>, <span class="va">project_url</span>, <span class="va">model_config</span><span class="op">)</span></span></code></pre></div>
<p>Now let’s upload a forecast to the model using
<code><a href="../reference/upload_forecast.html">upload_forecast()</a></code> and then see how to list all of a model’s
forecasts (in this case just the one).</p>
<blockquote>
<p>As we noted in <em>Getting Started with zoltr</em>, long operations
like querying or uploading forecasts are queued, and require polling to
determine when they are done.</p>
</blockquote>
<p><code><a href="../reference/upload_forecast.html">upload_forecast()</a></code> takes the <code>model_url</code> to
upload to, the <code>timezero_date</code> in the project to associate
the forecast with, and the <code>forecast_data</code> itself. The latter
is a nested <code>list</code> of <em>predictions</em> as documented in
<a href="https://docs.zoltardata.com/" class="external-link">docs.zoltardata.com</a>, but you
can learn about it by looking at the example
<code>docs-predictions.json</code>. Briefly, you can see that there is a
<code>predictions</code> list of <code>prediction elements</code> (the
<code>meta</code> section is ignored), each of which encodes data for a
particular unit and target combination. Each
<code>prediction element</code> has a class that’s one of four
possibilities: <code>bin</code>, <code>named</code>, <code>point</code>,
and <code>sample</code>. The structure of the
<code>prediction element's</code> contents (the <code>prediction</code>
section) is determined by the particular class. For example, a
<code>point</code> just has a <code>value</code>, but a <code>bin</code>
has a table of <code>cat</code> and <code>prob</code> values.</p>
<p>Here we will upload the <code>docs-predictions.json</code> file. Note
that the passed <code>timezero_date</code> matches one of the timezeros
in <code>docs-project.json</code>, the file that was used to create the
project. It is an error otherwise.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">forecast_data</span> <span class="op">&lt;-</span> <span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/read_json.html" class="external-link">read_json</a></span><span class="op">(</span><span class="st">"docs-predictions.json"</span><span class="op">)</span></span>
<span><span class="va">job_url</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/upload_forecast.html">upload_forecast</a></span><span class="op">(</span><span class="va">zoltar_connection</span>, <span class="va">model_url</span>, <span class="st">"2011-10-02"</span>, <span class="va">forecast_data</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/busy_poll_job.html">busy_poll_job</a></span><span class="op">(</span><span class="va">zoltar_connection</span>, <span class="va">job_url</span><span class="op">)</span></span></code></pre></div>
<p>Hopefully you’ll see some number of “QUEUED” entries followed by a
“SUCCESS” one. (How long it takes will depend on how much other work
Zoltar is handling.)</p>
<p>Get the new forecast’s URL from the <code>Job</code> object and then
call the <code><a href="../reference/forecasts.html">forecasts()</a></code> function to get a
<code>data.frame</code> of that model’s forecasts (just the one in our
case).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">the_job_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/job_info.html">job_info</a></span><span class="op">(</span><span class="va">zoltar_connection</span>, <span class="va">job_url</span><span class="op">)</span></span>
<span><span class="va">forecast_url</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/job_info_forecast_url.html">job_info_forecast_url</a></span><span class="op">(</span><span class="va">zoltar_connection</span>, <span class="va">the_job_info</span><span class="op">)</span></span>
<span><span class="va">the_forecast_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/forecast_info.html">forecast_info</a></span><span class="op">(</span><span class="va">zoltar_connection</span>, <span class="va">forecast_url</span><span class="op">)</span></span>
<span><span class="va">the_forecasts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/forecasts.html">forecasts</a></span><span class="op">(</span><span class="va">zoltar_connection</span>, <span class="va">the_forecast_info</span><span class="op">$</span><span class="va">forecast_model_url</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">the_forecasts</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    1 obs. of  12 variables:</span></span>
<span><span class="co">#&gt;  $ id                : int 109745</span></span>
<span><span class="co">#&gt;  $ url               : chr "https://rl-zoltar-staging.herokuapp.com/api/forecast/109745/"</span></span>
<span><span class="co">#&gt;  $ forecast_model_url: chr "https://rl-zoltar-staging.herokuapp.com/api/model/992/"</span></span>
<span><span class="co">#&gt;  $ source            : chr "forecast-19da771fe35e.json"</span></span>
<span><span class="co">#&gt;  $ timezero_url      : chr "https://rl-zoltar-staging.herokuapp.com/api/timezero/3753/"</span></span>
<span><span class="co">#&gt;  $ timezero_date     : Date, format: "2011-10-02"</span></span>
<span><span class="co">#&gt;  $ data_version_date : Date, format: NA</span></span>
<span><span class="co">#&gt;  $ is_season_start   : logi TRUE</span></span>
<span><span class="co">#&gt;  $ created_at        : POSIXct, format: "2024-04-08 12:53:01"</span></span>
<span><span class="co">#&gt;  $ issued_at         : POSIXct, format: "2024-04-08 12:53:01"</span></span>
<span><span class="co">#&gt;  $ notes             : chr ""</span></span>
<span><span class="co">#&gt;  $ forecast_data_url : chr "https://rl-zoltar-staging.herokuapp.com/api/forecast/109745/data/"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="clean-up-by-deleting-the-sandbox-project">Clean up by deleting the sandbox project<a class="anchor" aria-label="anchor" href="#clean-up-by-deleting-the-sandbox-project"></a>
</h3>
<p><strong>NB: This will delete all the data associated with the project
without warning, including models and forecasts.</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/delete_project.html">delete_project</a></span><span class="op">(</span><span class="va">zoltar_connection</span>, <span class="va">project_url</span><span class="op">)</span></span>
<span><span class="co">#&gt; Response [https://rl-zoltar-staging.herokuapp.com/api/project/369/]</span></span>
<span><span class="co">#&gt;   Date: 2024-04-08 12:53</span></span>
<span><span class="co">#&gt;   Status: 204</span></span>
<span><span class="co">#&gt;   Content-Type: &lt;unknown&gt;</span></span>
<span><span class="co">#&gt; &lt;EMPTY BODY&gt;</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Matthew Cornell, Nicholas Reich.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
